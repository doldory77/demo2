<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sys">
  <select id="selectCodeByParentCd">
    select cd, cd_nm, ord_no from code where parent_cd = #{parent_cd} order by ord_no
  </select>

  <select id="selectCodeByCd">
    select cd, parent_cd, cd_nm, ord_no from code where cd = #{cd}
  </select>
    
  <select id="selectMenu">
    select *
    from menu 
    where 1=1
        <if test="menu_cd != null and menu_cd != ''"> 
        and menu_cd = #{menu_cd}
        </if>
        <if test="parent_menu_cd != null and parent_menu_cd != ''"> 
        and parent_menu_cd = #{parent_menu_cd}
        </if>
    order by ord_no
  </select>

  <insert id="insertMember">
    insert into member (
      id,
      name,
      passwd,
      jikbun_cd,
      mw_cd
    ) values (
      #{id},
      #{name},
      password(#{passwd}),
      #{jikbun_cd},
      #{mw_cd}
    )  
  </insert>

  <insert id="insertCode">
    insert into code (
      cd,
      parent_cd,
      <if test="ord_no != null and ord_no != ''"> 
      ord_no,
      </if>
      cd_nm
    ) values (
      #{cd},
      #{parent_cd},
      <if test="ord_no != null and ord_no != ''"> 
      #{ord_no},
      </if>
      #{cd_nm}
    )  
  </insert>
  
  <update id="updateCode">
    update code set
      cd_nm = #{cd_nm},
      ord_no = #{ord_no}
    where cd = #{cd}
  </update>

  <select id="selectMemberNoById">
    select seq_no from member where id = #{id}
  </select>

  <insert id="insertContact">
    insert into contact (
      mb_seq_no, 
      kind_cd, 
      contact_no
    ) value (
      #{mb_seq_no}, 
      #{kind_cd}, 
      #{contact_no}
    )
  </insert>
  
</mapper>